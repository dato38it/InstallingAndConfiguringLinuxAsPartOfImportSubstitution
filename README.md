<p>Цель:<br># Установить и настроить Hyper-V в Windows Server 2012.<br># Протестировать клиентский компьютер RedOS на работоспособность с ПО.<br># Развернуть Pxe сервер для развертывания Redos с загрузкой в Uefi по сети.<br># Установить и настроить web-сервер для публикации файлов дистрибутива РЕД ОС в локальной сети.<br># Установить и настроить tftp.<br># Создать файл kickstart, Записать файл на локальный или удаленный носитель, Создать загрузочный диск, с которого будет запускаться установка, Предоставить доступ к установочной структуре, Начать процесс установки.<br># Установить и настроить РЕД ОС по PXE через VNC вместо Kickstart.<br># Установить виртуальный сервер AltLinux в Hyper-V.<br># Протестировать клиентский компьютер Alt Linux на работоспособность с ПО.<br>Skills:<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Task:</strong>  <br>Ввод компьютера в домен Windows и изменение имени хоста.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum install join-to-domain<br>[root@hvredos ~]# join-to-domain.sh<br>[root@hvredos ~]# reboot<br>[root@hvredos ~]# hostname hvredos.tdomain.ru<br>[root@hvredos ~]# hostname<br>hvredos.tdomain.ru<br>[root@hvredos ~]# vim /etc/hostname<br>[root@hvredos ~]# cat /etc/hostname<br>hvredos.tdomain.ru<br>[root@hvredos ~]# vim /etc/hosts<br>[root@hvredos ~]# cat /etc/hosts<br>127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4<br>::1 localhost localhost.localdomain localhost6 localhost6.localdomain6<br>127.0.0.1 hvredos.tdomain.ru hvredos<br><strong>Task:</strong><br>Установка Консультант Плюс и подключение сетевых директорий с использованием automount и механизма Kerberos.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum install wine winetricks<br># winetricks riched30 winhttp<br>- Wine - Wine Configuration - Графика - уберите галочку в пункте "Разрешить менеджеру окон декорировать окна". - Для запуска «Консультант Плюс» на рабочей станции подключите сетевой диск с «Консультантом» - Сделать это можно с помощью подключения сетевых директорий с использованием automount и механизма Kerberos<br>[root@hvredos ~]# smbclient -L hvredos -k<br>Sharename Type Comment<br>--------- ---- -------<br>Consultant Disk<br>ConsultantR Disk<br>S Disk<br>...<br>[root@hvredos ~]# yum install cifs-utils autofs<br>[root@hvredos ~]# klist<br>Ticket cache: FILE:/tmp/krb5cc_1<br>Default principal: tuser@tdomain.ru<br>Valid starting Expires service principal<br>31.08.2020 09:51:47 31.08.2020 19:51:47 krbtgt/tdomain.ru@tdomain.ru<br>renew until 31.08.2020 19:51:47<br>[root@hvredos ~]# vim /etc/auto.master<br>[root@hvredos ~]# cat /etc/auto.master<br>...<br>/mnt/.hpwindows&nbsp;&nbsp;/etc/auto.samba&nbsp;&nbsp;--ghost<br>[root@hvredos ~]# vim /etc/auto.samba<br>[root@hvredos ~]# cat /etc/auto.samba<br>Students&nbsp;&nbsp;  -fstype=cifs,multiuser,cruid=tuser,sec=krb5,domain=tdomain.ru,vers=2.1&nbsp;&nbsp; ://hpwindows/Students<br><strong>Task:</strong><br>Для подключения скрытых сетевых каталогов необходимо экранировать символ $.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>Consultant&nbsp;&nbsp;-fstype=cifs,multiuser,cruid=tuser,sec=krb5,domain=tdomain.ru,vers=2.1&nbsp;&nbsp; ://hpwindows/Consultant\$<br><strong>Task:</strong><br>В файле /etc/krb5.conf нужно закомментировать строку (если она ещё не закомментирована).<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# cat /etc/krb5.conf<br>...<br>default_ccache_name = KEYRING:persistent:%{uid}<br>...<br>[root@hvredos ~]# vim/etc/krb5.conf<br>[root@hvredos ~]# cat /etc/krb5.conf<br>...<br>default_ccache_name = FILE:/tmp/krb5cc_%{uid}<br>...<br>[root@hvredos ~]# systemctl start autofs.service<br>[root@hvredos ~]# systemctl enable autofs --now<br>[root@hvredos ~]# ls /mnt/.hpwindows/Consultant/<br>... cons.exe ...<br>[root@hvredos ~]# winecfg<br>[root@hvredos ~]# wine /mnt/.hpwindows/Сonsultant/cons.exe /linux /yes<br><strong>Task:</strong><br>Создать ярлык Консультант +.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /home/tuser@tdomain.ru/Рабочий\ стол/Consultant.desktop<br>[root@hvredos ~]# cat /home/tuser@tdomain.ru/Рабочий\ стол/Consultant.desktop<br>[Desktop Entry]<br>Name=ConsultantPlus<br>Exec=wine /mnt/.hpwindows/Сonsultant/cons.exe<br>Type=Application<br>StartupNotify=true<br>Comment=ConsultantPlus<br>icon=43D4_Cons.0<br>StartupWMClass=c.exe<br><strong>Task:</strong><br>В случае замедленной работы можно добавить ключ /sprocess=0.<br>При нормальной работе, не добавляйте этот ключ. <br>Ключ /yes необходим для подавления сообщения об ошибке <br>[WNetGetUniversalName ...] : NO_NETWORK<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# ln -s /mnt/.hvredos/S /home/tuser@tdomain.ru/Рабочий\ стол/S<br><strong>Task:</strong><br>Создание ярлыка для сетевой директории<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# ln -s /mnt/.hvredos/S /home/tuser@tdomain.ru/Рабочий\ стол/S<br><strong>Task:</strong><br>Oграничение доступа к USB накопителям.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /etc/udev/rules.d/99-usb.rules<br>[root@hvredos ~]# cat /etc/udev/rules.d/99-usb.rules<br>ENV{ID_USB_DRIVER}=="usb-storage",ENV{UDISKS_IGNORE}="1"<br># udevadm control --reload-rules<br><strong>Task:</strong><br>Запрет создания ярлыков и файлов на рабочем столе.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# tune2fs -l /dev/sda1 | grep "Default mount options:"<br>Default mount options: user_xattr acl<br>[root@hvredos ~]# vim /home/tuser@tdomain.ru/.config/user-dirs.dirs<br>[root@hvredos ~]# cat /home/tuser@tdomain.ru/.config/user-dirs.dirs<br># This file is written by xdg-user-dirs-update<br># If you want to change or add directories, just edit the line you're<br># interested in. All local changes will be retained on the next run<br># Format is XDG_xxx_DIR="$HOME/yyy", where yyy is a shell-escaped<br># homedir-relative path, or XDG_xxx_DIR="/yyy", where /yyy is an<br># absolute path. No other format is supported.<br>#<br>XDG_DESKTOP_DIR="$HOME/Рабочий стол"<br>XDG_DOWNLOAD_DIR="$HOME/Загрузки"<br>XDG_TEMPLATES_DIR="$HOME/Шаблоны"<br>XDG_PUBLICSHARE_DIR="$HOME/Общедоступные"<br>XDG_DOCUMENTS_DIR="$HOME/Документы"<br>XDG_MUSIC_DIR="$HOME/Музыка"<br>XDG_PICTURES_DIR="$HOME/Изображения"<br>XDG_VIDEOS_DIR="$HOME/Видео"<br>[root@hvredos ~]# ls -la /home/tuser@tdomain.ru/.config<br>...<br>-rw-------. 1 tuser ïîëüçîâàòåëè äîìåíà 714 àâã 31 09:52 user-dirs.dirs<br>-rw-r--r--. 1 tuser ïîëüçîâàòåëè äîìåíà 5 àâã 31 09:52 user-dirs.locale<br>[root@hvredos ~]# chown root:root /home/tuser@tdomain.ru/.config/user-dirs.dirs<br>[root@hvredos ~]# ls -la /home/tuser@tdomain.ru/.config<br>...<br>-rw-------. 1 root root 714 àâã 31 09:52 user-dirs.dirs<br>-rw-r--r--. 1 tuser ïîëüçîâàòåëè äîìåíà 5 àâã 31 09:52 user-dirs.locale<br>[root@hvredos ~]# ls -la<br>...<br>drwxr-xr-x. 2 tuser ïîëüçîâàòåëè äîìåíà 4096 àâã 31 09:52 'Рабочий стол'<br>...<br>[root@hvredos ~]# chown -R root:root /home/tuser@tdomain.ru/Рабочий\ стол/<br>[root@hvredos ~]# ls -la<br>...<br>drwxr-xr-x. 2 root root 4096 àâã 31 09:52 'Рабочий стол'<br>drwxr-xr-x. 2 tuser ïîëüçîâàòåëè äîìåíà 4096 àâã 31 09:52 Øàáëîíû<br><strong>Task:</strong><br>Как скрыть пользователей от экрана входа.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# cat /var/lib/AccountsService/users/user<br>[User]<br>Language=<br>XSession=<br>SystemAccount=false<br>[root@hvredos ~]# vim /var/lib/AccountsService/users/user<br>[root@hvredos ~]# cat /var/lib/AccountsService/users/user<br>[User]<br>Language=<br>XSession=gnome<br>SystemAccount=true<br><strong>Task:</strong><br>Добавление пользователя из доменной сети.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /var/lib/AccountsService/users/tuser<br>[root@hvredos ~]# cat /var/lib/AccountsService/users/tuser<br>[User]<br>Language=<br>XSession=<br>Icon=/home/tuser@tdomain.ru/.face<br>SystemAccount=false<br><strong>Task:</strong><br>Отключить сетевые принтеры.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /etc/avahi/avahi-daemon.conf<br>cat /etc/avahi/avahi-daemon.conf<br># This file is part of avahi.<br>...<br>enable-dbus=no<br>...<br>[root@hvredos ~]# reboot<br><strong>Task:</strong><br>Установка Gimp.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum provides gimp<br>[root@hvredos ~]# yum list | grep gimp<br>gimp.hvredos86 2:2.8.22-2.el7 base<br>[root@hvredos ~]# yum -y install gimp<br><strong>Task:</strong><br>Запись дисков Linux в терминале.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# ls<br>13 'MyTestX Tests'<br>[root@hvredos ~]# pwd<br>/home/tuser@tdomain.ru/Documents<br>[root@hvredos ~]# mkisofs -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# mkisofs -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# mkisofs -D -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>[root@hvredos ~]# mkisofs -J -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>Warning: creating filesystem with Joliet extensions but without Rock Ridge<br>extensions. It is highly recommended to add Rock Ridge.<br>...<br>Joliet tree sort failed. The -joliet-long switch may help you.<br>[root@hvredos ~]# -joliet-long<br>[root@hvredos ~]# mkisofs -J -joliet-long -l -o first.iso /home/tuser@tdomain.ru/Documents/13<br>Warning: creating filesystem with Joliet extensions but without Rock Ridge<br>extensions. It is highly recommended to add Rock Ridge.<br>...<br>99.90% done, estimate finish Fri Jan 15 11:29:00 2021<br>Total translation table size: 0<br>Total rockridge attributes bytes: 0<br>Total directory bytes: 0<br>Path table size(bytes): 10<br><strong>Task:</strong><br>Если вы собираетесь записать образ на диск ubuntu DVD-RW/CD-RW необходимо сначала его очистить. <br>Здесь и ниже /dev/sr0 - адрес файла вашего привода.<br>first.iso - это файл образа, 16 - скорость записи, а опция -eject - заставляет извлечь диск из привода после записи. <br>Можно указывать скорость 4, 8 и 16. Желательно выбирать минимальную скорость, так диск запишется более качественно.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# cdrecord -dev=/dev/sr0 -v blank=fast<br>[root@hvredos ~]# cd Documents/<br>[root@hvredos ~]# ls<br>13 first.iso 'MyTestX Tests'<br>[root@hvredos ~]# cdrecord -dev=/dev/sr0 -speed=16 -eject -v first.iso<br><strong>Task:</strong><br>Установка клиента 1С.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum -y install webkitgtk3<br>[root@hvredos ~]# ls<br>1C_Enterprise83-client-8.3.14-17.x86_64.rpm<br>1C_Enterprise83-common-8.3.14-17.x86_64.rpm<br>1C_Enterprise83-server-8.3.14-17.x86_64.rpm<br>[root@hvredos ~]# yum -y install 1C_Enterprise83-*<br><strong>Task:</strong><br>Установка аналога paint.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum list | grep paint<br>kolourpaint.hvredos86 17.12.1-2.el7 base<br>kolourpaint.x86_64 17.12.1-2.el7 base<br>kolourpaint-libs.hvredos86 17.12.1-2.el7 base<br>kolourpaint-libs.x86_64 17.12.1-2.el7 base<br>[root@hvredos ~]# yum -y install kolourpaint<br><strong>Task:</strong><br>Настройка оповещения и автоматического обновления пакетов в РЕД ОС с помощью yum-cron.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# yum -y install yum-cron<br>[root@hvredos ~]# vim /etc/yum/yum-cron.conf<br>[root@hvredos ~]# cat /etc/yum/yum-cron.conf<br>[commands]<br>...<br>apply_updates = no<br>[root@hvredos ~]# vim /etc/yum/yum-cron.conf<br>[root@hvredos ~]# cat /etc/yum/yum-cron.conf<br>[commands]<br>...<br>apply_updates = yes<br>[root@hvredos ~]# systemctl enable yum-cron --now<br><strong>Task:</strong>  <br>Если не требуется обновлять определенные пакеты (как вручную, так и автоматически), то добавляем их в исключение.<br>Например, kernel и php.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# nano /etc/yum.conf<br>exclude=kernel, php<br><strong>Task:</strong>  <br>Если не требуется обновлять пакеты ТОЛЬКО в автоматическом режиме, тогда в /etc/yum/yum-cron.conf , в раздел [base], добавляем следующую строку:<br># Администрирование локальных, виртуальных и облачных серверов.<br>Decision<br>[root@hvredos ~]# nano /etc/yum/yum-cron.conf<br>exclude=kernel* php*<br><strong>Task:</strong><br>Установка Anydesk.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# tee /etc/yum.repos.d/AnyDesk-RHEL.repo &lt;&lt;EOF<br>&gt; [anydesk]<br>&gt; name=AnyDesk RHEL - stable<br>&gt; baseurl=http://rpm.anydesk.com/rhel/\$basearch/<br>&gt; gpgcheck=1<br>&gt; repo_gpgcheck=1<br>&gt; gpgkey=https://keys.anydesk.com/repos/RPM-GPG-KEY<br>&gt; EOF<br>[root@hvredos ~]# dnf makecache<br>[root@hvredos ~]# dnf install -y redhat-lsb-core<br>[root@hvredos ~]# dnf install anydesk<br>[root@hvredos ~]# rpm -qi anydesk<br>[root@hvredos ~]# systemctl status anydesk.service<br>[root@hvredos ~]# exit<br>[root@hvredos ~]# anydesk<br><strong>Task:</strong><br>Создание загрузочных носителей.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# fdisk -l<br>...<br>Диск /dev/sdb: 3,61 GiB, 3880452096 байт, 7579008 секторов<br>Disk model: Silicon-Power4G<br>Единицы: секторов по 1 * 512 = 512 байт<br>Размер сектора (логический/физический): 512 байт / 512 байт<br>Размер I/O (минимальный/оптимальный): 512 байт / 512 байт<br>Тип метки диска: gpt<br>Идентификатор диска: 2BAC44AA-F36D-461C-B12A-D251E7E9373F<br>Устр-во&nbsp;&nbsp;начало   Конец Секторы Размер Тип<br>/dev/sdb1&nbsp;&nbsp;2048 7578974 7576927   3,6G Microsoft basic data<br>[root@hvredos ~]# ls<br>Zorin-OS-16.1-Core-64-bit.iso<br>[root@hvredos ~]# dd if=Zorin-OS-16.1-Core-64-bit.iso of=/dev/sdb1 bs=8MB status=progress oflag=direct<br>3058237440 байт (3,1 GB, 2,8 GiB) скопирован, 659 s, 4,6 MB/s<br>382+1 записей получено<br>382+1 записей отправлено<br>3058237440 байт (3,1 GB, 2,8 GiB) скопирован, 659,39 s, 4,6 MB/s<br><strong>Task:</strong><br>Развернуть Pxe сервер для развертывания Redos с загрузкой в Uefi по сети.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# ifconfig<br>enp2s0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>&nbsp;&nbsp;inet tipwindowsserver  netmask Mask1  broadcast IpAddr.255<br>&nbsp;&nbsp;...<br>[root@hvredos ~]# dnf install dhcp tftp-server syslinux httpd dnf-plugins-core -y<br>[root@hvredos ~]# mkdir /var/lib/tftpboot/pxelinux.cfg<br>[root@hvredos ~]# mkdir /var/lib/tftpboot/uefi<br>[root@hvredos ~]# mkdir -p /var/lib/tftpboot/images/REDOS<br>[root@hvredos ~]# cp /usr/share/syslinux/{chain.c32,mboot.c32,memdisk,menu.c32,pxelinux.0,ldlinux.c32,libutil.c32} /var/lib/tftpboot/<br>[root@hvredos ~]# chmod 777 /var/lib/tftpboot/pxelinux.0<br>[root@hvredos ~]# dnf download shim-x64 grub2-efi-x64 --downloaddir=/root/<br>[root@hvredos ~]# cd /root/<br>[root@hvredos ~]# rpm2cpio shim-x64-*.rpm | cpio -dimv<br>[root@hvredos ~]# rpm2cpio grub2-efi-x64-*.rpm | cpio -dimv<br>[root@hvredos ~]# cp ./boot/efi/EFI/BOOT/BOOTX64.EFI /var/lib/tftpboot/uefi<br>[root@hvredos ~]# cp ./boot/efi/EFI/redos/grubx64.efi /var/lib/tftpboot/uefi<br>[root@hvredos ~]# chmod 777 /var/lib/tftpboot/uefi/*.*<br>[root@hvredos ~]# umount -t iso9660 -o loop redos-MUROM-7.3.2-20211027.0-Everything-x86_64-DVD1.iso /mnt/<br>[root@hvredos ~]# cp -vR /mnt/* /var/lib/tftpboot/images/REDOS/<br>[root@hvredos ~]# umount /mnt/<br>[root@hvredos ~]# vim /etc/dhcp/dhcpd.conf<br>[root@hvredos ~]# cat /etc/dhcp/dhcpd.conf<br>non-authoritative;<br>allow bootp;<br>option space pxelinux;<br>option pxelinux.magic code 208 = string;<br>option pxelinux.configfile code 209 = text;<br>option pxelinux.pathprefix code 210 = text;<br>option pxelinux.reboottime code 211 = unsigned integer 32;<br>option architecture-type code 93 = unsigned integer 16;<br>subnet tipwindowsserver.0 netmask Mask1 {<br>option routers tipwindowsserver;<br>range tipwindowsserver.70 tipwindowsserver.80;<br>class "pxeclients" {<br>match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";<br>next-server tipwindowsserver;<br>if option architecture-type = 00:07 {<br>filename "uefi/grubx64.efi";<br>} <br>else {<br>filename "pxelinux.0";<br>}<br>}<br>} <br># systemctl enable dhcpd --now<br>[root@hvredos ~]# vim /var/lib/tftpboot/pxelinux.cfg/default<br>[root@hvredos ~]# cat /var/lib/tftpboot/pxelinux.cfg/default<br>default menu.c32<br>PROMPT 0<br>TIMEOUT 150<br>MENU TITLE PXE Menu<br>LABEL REDOS 7.3<br>MENU LABEL REDOS 7.3<br>KERNEL images/REDOS/images/pxeboot/vmlinuz<br>APPEND initrd=images/REDOS/images/pxeboot/initrd.img ramdisk_size=128000 ip=dhcp inst.repo=http://tipwindowsserver/images/REDOS/ <br>[root@hvredos ~]# vim /var/lib/tftpboot/uefi/grub.cfg <br>[root@hvredos ~]# cat /var/lib/tftpboot/uefi/grub.cfg <br>function load_video { <br>insmod efi_gop  <br>insmod efi_uga <br>insmod video_bochs <br>insmod video_cirrus <br>insmod all_video <br>} <br>load_video <br>set gfxpayload=keep <br>insmod gzio <br>menuentry 'REDOS 7.3' { <br>linux images/REDOS/images/pxeboot/vmlinuz ip=dhcp inst.repo=http://tipwindowsserver/images/REDOS/ <br>initrd images/REDOS/images/pxeboot/initrd.img <br>} <br><strong>Task:</strong><br>Используем web-сервер для публикации файлов дистрибутива РЕД ОС в локальной сети.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /etc/httpd/conf.d/pxeboot.conf <br>[root@hvredos ~]# cat /etc/httpd/conf.d/pxeboot.conf <br>Alias /images /var/lib/tftpboot/images <br>&lt;Directory /var/lib/tftpboot/images&gt; <br>Options Indexes FollowSymLinks <br>Require ip 127.0.0.1 tipwindowsserver.0/24 <br>&lt;/Directory&gt;<br>[root@hvredos ~]# systemctl enable httpd --now<br><strong>Task:</strong><br>Настройка и запуск службы tftp.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /usr/lib/systemd/system/tftp.service<br>[root@hvredos ~]# cat /usr/lib/systemd/system/tftp.service<br>...<br>[Install]:<br>WantedBy=multi-user.target <br>Also=tftp.socket<br>...<br>[root@hvredos ~]# vim /usr/lib/systemd/system/tftp.socket<br>[root@hvredos ~]# cat /usr/lib/systemd/system/tftp.socket<br>...<br>[Unit] <br>Description=Tftp Server Activation Socket <br>[Socket] <br>ListenDatagram=0.0.0.0:69 <br>[Install] <br>WantedBy=sockets.target <br>...<br>[root@hvredos ~]# systemctl daemon-reload<br>[root@hvredos ~]# systemctl enable tftp --now<br>[root@hvredos ~]# ausearch -c 'httpd' --raw | audit2allow -M my-httpd<br>[root@hvredos ~]# semodule -i my-httpd.pp<br><strong>Task:</strong><br>Автоматизация развертывания (kickstart)<br>Создать файл kickstart, Записать файл на локальный или удаленный носитель, Создать загрузочный диск, с которого будет запускаться установка, Предоставить доступ к установочной структуре, Начать процесс установки.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# dnf install pykickstart -y<br>[root@hvredos ~]# cp /root/anaconda-ks.cfg /var/lib/tftpboot<br>[root@hvredos ~]# mv /var/lib/tftpboot/anaconda-ks.cfg /var/lib/tftpboot/ks.cfg<br>[root@hvredos ~]# vim /var/lib/tftpboot/pxelinux.cfg/default<br>[root@hvredos ~]# cat /var/lib/tftpboot/pxelinux.cfg/default<br>...<br>APPEND initrd=images/REDOS/images/pxeboot/initrd.img ramdisk_size=128000 ip=dhcp method=http://tipwindowsserver/images/REDOS/ devfs=nomount inst.ks=http://tipwindowsserver/ks.cfg <br>[root@hvredos ~]# vim /var/lib/tftpboot/uefi/grub.cfg<br>[root@hvredos ~]# cat /var/lib/tftpboot/uefi/grub.cfg<br>... { <br>linux images/REDOS/images/pxeboot/vmlinuz ip=dhcp kernel vmlinuz inst.repo=http://tipwindowsserver/images/REDOS/ inst.ks=http://tipwindowsserver/ks.cfg <br>initrd images/REDOS/images/pxeboot/initrd.img<br>} <br>[root@hvredos ~]# vim /var/lib/tftpboot/ks.cfg<br>[root@hvredos ~]# cat /var/lib/tftpboot/ks.cfg<br># Здесь указываем раскладку клавиатуры<br>keyboard --vckeymap=us --xlayouts='us','ru' --switch='grp:alt_shift_toggle'<br># Системная локаль<br>lang ru_RU.UTF-8<br># Информация о сетевом интерфейсе и имя машины<br>network  --bootproto=dhcp --device=enp2s0 --noipv6 --activate<br>network  --hostname=hostname1337<br># Пароль Root представлен в виде хэш-суммы<br>rootpw --iscrypted $6$DUu0yyOYMRbGS8gL$9zHYPsxROGEZdDKG0wnf7h8SGnKOp3V272De6oGTVUsz2uBLmEeiR6T6cInRN5dyWcxNXh5fVluEUTQ/3rmzB0<br># Настройка сервисов (в данном случае сервис по обновлению меток времени и дат)<br>services --enabled="chronyd"<br># Настройка временной зоны<br>timezone Europe/Moscow --isUtc<br>#Настройка локального пользователя<br>user --groups=wheel --name=mekka --password=$6$83fyYZ7KMS7G9t6A$E5/99/ffOwjUOo8THr1ngqGDdKMimpTZf3IT9S/SI98BTV7dta7GksLYnQEZjtqqyZQrwibSRlvYccRqHB7m8/ --iscrypted --gecos="Mekka"<br># Настройка xorg при загрузке<br>xconfig  --startxonboot<br># Указание загрузочного сектора и тип структуры<br>bootloader --location=mbr --boot-drive=sda<br># Удаление всей информации с партиций для последующей установки<br>clearpart --none --initlabel<br># Здесь указана вся разметка диска<br>part /boot --fstype="xfs" --onpart=sda2<br>part biosboot --fstype="biosboot" --noformat --onpart=sda4<br>part pv.31 --fstype="lvmpv" --noformat --onpart=sda3<br>part /boot/efi --fstype="efi" --onpart=sda1 --fsoptions="umask=0077,shortname=winnt"<br>volgroup ro --noformat --useexisting<br>logvol swap  --fstype="swap" --useexisting --name=swap --vgname=ro<br>logvol /home  --fstype="xfs" --noformat --useexisting --name=home --vgname=ro<br>logvol /  --fstype="ext4" --useexisting --name=root --vgname=ro<br>#дополнительные пакеты для установки<br>%packages<br>@^mate-desktop-environment<br>@backup-client<br>@base<br>@branding<br>@core<br>@desktop-debugging<br>@dial-up<br>@directory-client<br>@fonts<br>@guest-agents<br>@guest-desktop-agents<br>@input-methods<br>@internet-applications<br>@internet-browser<br>@java-platform<br>@mate-desktop<br>@multimedia<br>@network-file-system-client<br>@print-client<br>@x11<br>chrony<br>%end<br>#настройка аварийных дампов памяти в случае сбоев (оставить как есть)<br>%addon com_redhat_kdump --enable --reserve-mb='auto'<br>%end<br>#настройка анаконды (оставить как есть)<br>%anaconda<br>pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty<br>pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok<br>pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty<br>%end<br><strong>Task:</strong><br>Настройка установки РЕД ОС по PXE через VNC вместо Kickstart.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>[root@hvredos ~]# vim /var/lib/tftpboot/pxelinux.cfg/default<br>[root@hvredos ~]# cat /var/lib/tftpboot/pxelinux.cfg/default<br>...<br>APPEND initrd=images/REDOS/images/pxeboot/initrd.img ramdisk_size=128000 ip=dhcp method=http://tipwindowsserver/images/REDOS/ devfs=nomount inst.vnc inst.vncpassword=tpassword<br>[root@hvredos ~]# vim /var/lib/tftpboot/uefi/grub.cfg<br>[root@hvredos ~]# cat /var/lib/tftpboot/uefi/grub.cfg<br>... { <br>linux images/REDOS/images/pxeboot/vmlinuz ip=dhcp kernel vmlinuz inst.repo=http://tipwindowsserver/images/REDOS/ inst.vnc inst.vncpassword=tpassword<br>initrd images/REDOS/images/pxeboot/initrd.img<br>}<br><strong>Source:</strong><br># https://redos.red-soft.ru/base/other-soft/other-other/consultant/?sphrase_id=53349<br># https://wtuseri.astralinutdomain.ru/pages/viewpage.action?pageId=61574227<br># https://askubuntu.ru/questions/21203/kak-skry-t-pol-zovatelej-ot-e-krana-vxoda-v-gdm<br># https://computingforgeeks.com/how-to-install-gimp-on-centos-rhel-8-desktop/<br># https://ru.wtuserihow.com/%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C-ISO-%D1%84%D0%B0%D0%B9%D0%BB-%D0%B2-Linux<br># https://losst.ru/zapis-diskov-v-ubuntu<br># https://losst.ru/luchshie-analogi-paint-dlya-linux <br># https://computingforgeeks.com/how-to-install-anydesk-on-centos-rhel-8/<br><strong>Task:</strong><br>Set up an ActiveDirectory/Login.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>root@hvalt:~# apt-get install task-auth-ad-sssd<br>root@hvalt:~# net time set -S tdomain.ru<br># system-auth write ad tdomain.ru hvalt hvalt 'tuser' 'tpassword'<br>Using short domain name -- hvalt<br>Joined 'hvalt' to dns domain 'tdomain.ru'<br>Successfully registered hostname with DNS<br>failed to call wbcGetDisplayName: WBC_ERR_WINBIND_NOT_AVAILABLE<br>Could not lookup sid S-1-5-21-965402400-3010625364-1855727791-513<br>failed to call wbcGetDisplayName: WBC_ERR_WINBIND_NOT_AVAILABLE<br>Could not lookup sid S-1-5-21-965402400-3010625364-1855727791-512<br>root@hvalt:~# wbinfo -t<br>checking the trust secret for domain hvredos via RPC calls succeeded<br>root@hvalt:~# acc<br>2 keyboards found<br>qt.qpa.xcb: could not connect to display<br>qt.qpa.plugin: Could not load the Qt platfohvredos plugin "xcb" in "" even though it was found.<br>This applhvredosation failed to start because no Qt platfohvredos plugin could be initialized. Reinstalling the applhvredosation may fix this problem.<br>Available platfohvredos plugins are: eglfs, linuxfb, minimal, minimalegl, offscreen, vnc, xcb.<br>root@hvalt:~# exit<br>root@hvalt:~# exit<br>[root@hvredos ~]# ssh -X tuser@hvalt<br>root@hvalt:~# su -<br>root@hvalt:~# acc<br>2 keyboards found<br>QStandardPaths: XDG_RUNTIME_DIR not set, defaulting to '/tmp/.private/root/runtime-root'<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>WARNING: (alterator lookout evaluation): imported module (alterator presentation events) overrides core binding `when'<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>libpng warning: hvredosCP: known incorrect sRGB profile<br>root@hvalt:~# vim /etc/net/ifaces/eth0/resolv.conf<br>root@hvalt:~# cat /etc/net/ifaces/eth0/resolv.conf<br>nameserver tipwindowsserver<br>root@hvalt:~# hostnamectl set-hostname hvalt.tdomain.ru<br>root@hvalt:~# cat /etc/resolv.conf<br>search tdomain.ru<br>nameserver 127.0.0.1<br>root@hvalt:~# vim /etc/resolv.conf<br>root@hvalt:~# cat /etc/resolv.conf<br># Configuration for resolv(8)<br># See resolv.conf(5) for details<br>resolv_conf_head='# Do not edit manually, use\n# /etc/net/ifaces/&lt;interface&gt;/resolv.conf instead.'<br>resolv_conf=/etc/resolv.conf<br># These interfaces will always be processed first.<br>interface_order='lo lo[0-9]* lo.*'<br># These interfaces will be processed next, unless they have a metrhvredos.<br>dynamhvredos_order='tap[0-9]* tun[0-9]* vpn vpn[0-9]* wg[0-9]* ppp[0-9]* ippp[0-9]*'<br>#Configuration files for named subscriber.<br>named_zones=/var/lib/bind/etc/resolv-zones.conf<br>named_options=/var/lib/bind/etc/resolv-options.conf<br>#Configuration files for dnsmasq subscriber.<br>dnsmasq_conf=/etc/dnsmasq.conf.d/60-resolv<br>dnsmasq_resolv=/etc/resolv.conf.dnsmasq<br>name_servers=127.0.0.1<br>root@hvalt:~# vim /etc/resolv.conf<br>root@hvalt:~# cat /etc/resolv.conf<br># Configuration for resolv(8)<br># See resolv.conf(5) for details<br>resolv_conf_head='# Do not edit manually, use\n# /etc/net/ifaces/&lt;interface&gt;/resolv.conf instead.'<br>resolv_conf=/etc/resolv.conf<br># These interfaces will always be processed first.<br>#interface_order='lo lo[0-9]* lo.*'<br>interface_order='lo lo[0-9]* lo.* eth0'<br>search_domains=tdomain.ru<br># These interfaces will be processed next, unless they have a metrhvredos.<br>dynamhvredos_order='tap[0-9]* tun[0-9]* vpn vpn[0-9]* wg[0-9]* ppp[0-9]* ippp[0-9]*'<br>#Configuration files for named subscriber.<br>named_zones=/var/lib/bind/etc/resolv-zones.conf<br>named_options=/var/lib/bind/etc/resolv-options.conf<br>#Configuration files for dnsmasq subscriber.<br>dnsmasq_conf=/etc/dnsmasq.conf.d/60-resolv<br>dnsmasq_resolv=/etc/resolv.conf.dnsmasq<br>#name_servers=127.0.0.1<br>root@hvalt:~# resolv -u<br>root@hvalt:~# cat /etc/resolv.conf<br># Generated by resolv<br># Do not edit manually, use<br># /etc/net/ifaces/&lt;interface&gt;/resolv.conf instead.<br>search tdomain.ru<br>nameserver tipwindowsserver<br>...<br>nameserver 8.8.8.8<br>root@hvalt:~# hostname<br>hvalt.tdomain.ru<br>root@hvalt:~# dig _kerberos._udp.tdomain.ru SRV | grep ^_kerberos<br>_kerberos._udp.tdomain.ru. 600 IN SRV 0 100 88 M-1.tdomain.ru.<br>...<br>_kerberos._udp.tdomain.ru. 600 IN SRV 0 100 88 T-1.tdomain.ru.<br>root@hvalt:~# dig _kerberos._tcp.tdomain.ru SRV | grep ^_kerberos<br>_kerberos._tcp.tdomain.ru. 600 IN SRV 0 100 88 M-c.tdomain.ru.<br>...<br>_kerberos._tcp.tdomain.ru. 600 IN SRV 0 100 88 T-1.tdomain.ru.<br>root@hvalt:~# cat /etc/krb5.conf | grep default_realm<br>default_realm = tdomain.ru<br># default_realm = EXAMPLE.COM<br>root@hvalt:~# cat /etc/krb5.conf | grep dns_lookup_realm<br>dns_lookup_realm = false<br>root@hvalt:~# cat /etc/krb5.conf | grep dns_lookup_kdc<br>dns_lookup_kdc = true<br>root@hvalt:~# exit<br>[root@hvredos ~]# ssh -X tuser@hvalt<br>root@hvalt:~# kinit tuser<br>root@hvalt:~# klist<br>Thvredosket cache: KEYRING:persistent:0:krb_ccache_CCjHpN1<br>Default principal: a-r@tdomain.ru<br>Valid starting&nbsp;&nbsp;   Expires&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Servhvredose principal<br>10.08.2022 12:30:34  10.08.2022 22:30:34  krbtgt/tdomain.ru@tdomain.ru<br>&nbsp;&nbsp;renew until 17.08.2022 12:30:32<br>root@hvalt:~# apt-get install samba-client<br>root@hvalt:~# cat /etc/samba/smb.conf | grep realm<br>&nbsp;&nbsp;realm = tdomain.ru<br>root@hvalt:~# cat /etc/samba/smb.conf | grep workgroup<br>&nbsp;&nbsp;workgroup = hvalt<br>root@hvalt:~# cat /etc/samba/smb.conf | grep netbios<br>&nbsp;&nbsp;netbios name = hvalt<br>root@hvalt:~# cat /etc/samba/smb.conf | grep security<br>&nbsp;&nbsp;security = ads<br>root@hvalt:~# cat /etc/samba/smb.conf | grep method<br>&nbsp;&nbsp;kerberos method = system keytab<br>root@hvalt:~# cat /etc/samba/smb.conf | grep idmap<br>&nbsp;&nbsp;&nbsp;&nbsp;idmap config * : range = 200000-2000200000<br>&nbsp;&nbsp;&nbsp;&nbsp;idmap config * : backend = sss<br>root@hvalt:~# vim /etc/samba/smb.conf<br>root@hvalt:~# cat /etc/samba/smb.conf | grep idmap<br>&nbsp;&nbsp;&nbsp;&nbsp;idmap config * : range = 200000-2000200000<br>;&nbsp;&nbsp;&nbsp;&nbsp;idmap config * : backend = sss<br>&nbsp;&nbsp;idmap config * : backend = tdb<br># testpahvalt<br>Load smb config files from /etc/samba/smb.conf<br>Loaded servhvredoses file OK.<br>Weak crypto is allowed<br>Server role: ROLE_DOMAIN_MEMBER<br>Press enter to see a dump of your servhvredose definitions<br># Global parameters<br>[global]<br>&nbsp;&nbsp;kerberos method = system keytab<br>&nbsp;&nbsp;machine password timeout = 0<br>&nbsp;&nbsp;realm = tdomain.ru<br>&nbsp;&nbsp;security = ADS<br>&nbsp;&nbsp;template homedir = /home/tdomain.ru/%U<br>&nbsp;&nbsp;template shell = /bin/bash<br>&nbsp;&nbsp;winbind use default domain = Yes<br>&nbsp;&nbsp;workgroup = hvredos<br>&nbsp;&nbsp;idmap config * : range = 200000-2000200000<br>&nbsp;&nbsp;idmap config * : backend = tdb<br>[share]<br>&nbsp;&nbsp;comment = Commonplace<br>&nbsp;&nbsp;path = /srv/share<br>&nbsp;&nbsp;read only = No<br>[homes]<br>&nbsp;&nbsp;browseable = No<br>&nbsp;&nbsp;comment = Home Directory for '%u'<br>&nbsp;&nbsp;read only = No<br>root@hvalt:~# cat /etc/hosts<br>127.0.0.1   localhost.localdomain localhost<br>root@hvalt:~# vim /etc/hosts<br>root@hvalt:~# cat /etc/hosts<br>127.0.0.1   hvalt.tdomain.ru hvalt<br>root@hvalt:~# net ads join -U tuser<br>Enter tuser's password:<br>Using short domain name -- hvalt<br>Joined 'hvalt' to dns domain 'tdomain.ru'<br>root@hvalt:~# klist -k -e<br>Keytab name: FILE:/etc/krb5.keytab<br>KVNO Principal<br>---- --------------------------------------------------------------------------<br>9 host/hvalt.tdomain.ru@tdomain.ru (aes256-cts-hmac-sha1-96)<br>9 host/hvalt@tdomain.ru (aes256-cts-hmac-sha1-96)<br>9 host/hvalt.tdomain.ru@tdomain.ru (aes128-cts-hmac-sha1-96)<br>9 host/hvalt@tdomain.ru (aes128-cts-hmac-sha1-96)<br>9 host/hvalt.tdomain.ru@tdomain.ru (DEPRECATED:arcfour-hmac)<br>9 host/hvalt@tdomain.ru (DEPRECATED:arcfour-hmac)<br>9 hvalt$@tdomain.ru (aes256-cts-hmac-sha1-96)<br>9 hvalt$@tdomain.ru (aes128-cts-hmac-sha1-96)<br>9 hvalt$@tdomain.ru (DEPRECATED:arcfour-hmac)<br>8 host/hvalt.tdomain.ru@tdomain.ru (aes256-cts-hmac-sha1-96)<br>8 host/hvalt@tdomain.ru (aes256-cts-hmac-sha1-96)<br>8 host/hvalt.tdomain.ru@tdomain.ru (aes128-cts-hmac-sha1-96)<br>8 host/hvalt@tdomain.ru (aes128-cts-hmac-sha1-96)<br>8 host/hvalt.tdomain.ru@tdomain.ru (DEPRECATED:arcfour-hmac)<br>8 host/hvalt@tdomain.ru (DEPRECATED:arcfour-hmac)<br>8 hvalt$@tdomain.ru (aes256-cts-hmac-sha1-96)<br>8 hvalt$@tdomain.ru (aes128-cts-hmac-sha1-96)<br>8 hvalt$@tdomain.ru (DEPRECATED:arcfour-hmac)<br>root@hvalt:~# apt-get install sssd-ad<br>root@hvalt:~# cat /etc/sssd/sssd.conf<br>[sssd]<br>config_file_version = 2<br>servhvredoses = nss, pam<br># Managed by system facility command:<br>## control sssd-drop-privileges unprivileged|privileged|default<br>user = _sssd<br># SSSD will not start if you do not configure any domains.<br>domains = tdomain.ru<br>[nss]<br>[pam]<br>[domain/tdomain.ru]<br>id_provider = ad<br>auth_provider = ad<br>chpass_provider = ad<br>access_provider = ad<br>default_shell = /bin/bash<br>fallback_homedir = /home/%d/%u<br>debug_level = 0<br>; cache_credentials = false<br>ad_gpo_ignore_unreadable = true<br>ad_gpo_access_control = pehvredosissive<br>ad_update_samba_machine_account_password = true<br>root@hvalt:~# vim /etc/sssd/sssd.conf<br>root@hvalt:~# cat /etc/sssd/sssd.conf<br>[sssd]<br>config_file_version = 2<br>servhvredoses = nss, pam<br># Managed by system facility command:<br>## control sssd-drop-privileges unprivileged|privileged|default<br>#user = _sssd<br>user=root<br># SSSD will not start if you do not configure any domains.<br>domains = tdomain.ru<br>[nss]<br>[pam]<br>[domain/tdomain.ru]<br>id_provider = ad<br>auth_provider = ad<br>chpass_provider = ad<br>access_provider = ad<br>;ldap_id_mapping = False<br>default_shell = /bin/bash<br>fallback_homedir = /home/%d/%u<br>debug_level = 0<br>;use_fully_qualified_names = True<br>; cache_credentials = True<br>ad_gpo_ignore_unreadable = true<br>ad_gpo_access_control = pehvredosissive<br>ad_update_samba_machine_account_password = true<br>root@hvalt:~# grep sss /etc/nsswitch.conf<br>passwd: files sss<br>shadow: tcb files sss<br>group: files [SUCCESS=merge] sss role<br>root@hvalt:~# control system-auth sss<br>root@hvalt:~# servhvredose sssd status<br>active<br>root@hvalt:~# servhvredose sssd start<br>root@hvalt:~# getent passwd tuser<br>tuser:*:1-9:1-3:в-н:/home/tdomain.ru/tuser:/bin/bash<br>root@hvalt:~# id tuser<br>uid=1-9(tuser) gid=1-3(пользователи домена) группы=1-3(пользователи домена),1-8(администраторы dhcp),1-0(tuser),11-0(пользователи филиалы),1-1(tuser),1-9(i-n)<br>root@hvalt:~# net ads info<br>LDAP server: IpAddr2<br>LDAP server name: MOW-1.tdomain.ru<br>Realm: tdomain.ru<br>Bind Path: dc=hvalt,dc=RU<br>LDAP port: 389<br>Server time: Ср, 10 авг 2022 13:08:06 +08<br>KDC server: IpAddr2<br>Server time offset: 0<br>Last machine account password change: Ср, 10 авг 2022 12:50:51 +08<br>root@hvalt:~# net ads testjoin<br>Join is OK<br>root@hvalt:~# cat /etc/lightdm/lightdm.conf | grep greeter-hide-<br># greeter-hide-users = True to hide the user list<br>#greeter-hide-users=false<br>greeter-hide-users = true<br>root@hvalt:~# cat /etc/lightdm/lightdm-gtk-greeter.conf | grep show-language<br>show-language-selector = false<br>root@hvalt:~# cat /etc/lightdm/lightdm-gtk-greeter.conf | grep show-indhvredosators<br>root@hvalt:~# vim /etc/lightdm/lightdm-gtk-greeter.conf<br>root@hvalt:~# cat /etc/lightdm/lightdm-gtk-greeter.conf | grep show-indhvredosators<br>show-indhvredosators=~a11y;~power;~session;~language<br>root@hvalt:~# vim /etc/lightdm/lightdm-gtk-greeter.conf<br>root@hvalt:~# cat /etc/lightdm/lightdm-gtk-greeter.conf | grep enter-<br>enter-username = true<br>root@hvalt:~# reboot<br><strong>Task:</strong><br>Учетные записи и групп в Альт Линукс.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>root@hvalt:~# apt-get install libnss-role<br>root@hvalt:~# groupadd -r localadmins<br>groupadd: группа «localadmins» уже существует<br>root@hvalt:~# groupadd -r remote<br>groupadd: группа «remote» уже существует<br>root@hvalt:~# control sshd-allow-groups enabled<br>root@hvalt:~# sed -i 's/AllowGroups.*/AllowGroups = remote/' /etc/openssh/sshd_config<br>root@hvalt:~# roleadd users cdwriter cdrom audio proc radio camera floppy xgrp scanner uucp fuse<br>root@hvalt:~# roleadd localadmins wheel remote vboxusers<br>root@hvalt:~# roleadd 'Domain Users' users<br>Error 156: No such group<br>root@hvalt:~# roleadd 'Пользователи домена' users<br>root@hvalt:~# roleadd 'Администраторы домена' localadmins<br>root@hvalt:~# rolelst<br>users:cdwriter,cdrom,audio,proc,radio,camera,floppy,xgrp,scanner,uucp,fuse,video,vboxusers,vboxadd<br>localadmins:wheel,remote,vboxusers,vboxadd<br>пользователи домена:users<br>администраторы домена:localadmins<br>powerusers:remote,vboxadd,vboxusers<br>vboxadd:vboxsf<br>root@hvalt:~# id tuser<br>uid=1-9(tuser) gid=1-3(пользователи домена) группы=1-3(пользователи домена),11-0(пользователи филиалы),1-9(i-n),1-0(tuser),1-1(tuser),1-8(администраторы dhcp),100(users),80(cdwriter),22(cdrom),81(audio),19(proc),83(radio),440(camera),71(floppy),466(xgrp),467(scanner),14(uucp),483(fuse),488(video),481(vboxusers),455(vboxadd),454(vboxsf)<br>root@hvalt:~# roleadd 'tuser' localadmins<br>root@hvalt:~# roleadd 'tuser' wheel<br>root@hvalt:~# rolelst<br>users:cdwriter,cdrom,audio,proc,radio,camera,floppy,xgrp,scanner,uucp,fuse,video,vboxusers,vboxadd<br>localadmins:wheel,remote,vboxusers,vboxadd<br>пользователи домена:users<br>администраторы домена:localadmins<br>tuser:localadmins<br>powerusers:remote,vboxadd,vboxusers<br>vboxadd:vboxsf<br>root@hvalt:~# exit<br>[root@hvredos ~]# ssh -X tuser@hvalt<br>root@hvalt:~# id tuser<br>uid=1-9(tuser) gid=1-3(пользователи домена) группы=1-3(пользователи домена),11-0(пользователи филиалы),1-9(i-n),1-0(tuser),1-1(tuser),1-8(администраторы dhcp),100(users),80(cdwriter),22(cdrom),81(audio),19(proc),83(radio),440(camera),71(floppy),466(xgrp),467(scanner),14(uucp),483(fuse),488(video),481(vboxusers),455(vboxadd),454(vboxsf),101(localadmins),10(wheel),110(remote)<br><strong>Task:</strong><br>Добавить сетевые папки.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>root@hvalt:~# apt-get install autofs<br>root@hvalt:~# vim /etc/auto.master<br>root@hvalt:~# cat /etc/auto.master<br># Fohvredosat of this file:<br># mountpoint map options<br># For details of the fohvredosat look at autofs(8).<br>/mnt/auto   /etc/auto.tab   -t 5<br>/mnt/net&nbsp;&nbsp;/etc/auto.avahi -t 120<br>/mnt/.tdirectory  /etc/auto.samba --ghost<br>root@hvalt:~# vim /etc/auto.samba<br>root@hvalt:~# cat /etc/auto.samba<br>s&nbsp;&nbsp;-fstype=cifs,multiuser,cruid=$USER,sec=krb5,domain=tdomain.ru,vers=1.0 ://hvalt/tdirectory1<br>o&nbsp;&nbsp;-fstype=cifs,multiuser,cruid=$USER,sec=krb5,domain=tdomain.ru,vers=1.0 ://hvalt/tdirectory2<br>root@hvalt:~# systemctl enable autofs<br>root@hvalt:~# systemctl start autofs<br>root@hvalt:~# ls -la /mnt/.tdirectory/<br>drwxr-xr-x 4 root root&nbsp;&nbsp;0 авг 11 14:09 .<br>drwxr-xr-x 5 root root 4096 авг 11 14:09 ..<br>d????????? ? ?&nbsp;&nbsp;?&nbsp;&nbsp;   ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? o<br>d????????? ? ?&nbsp;&nbsp;?&nbsp;&nbsp;   ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? s<br><strong>Task:</strong><br>Creating a Network Bridge interface.<br># Администрирование локальных, виртуальных и облачных серверов.<br><strong>Decision:</strong><br>root@hvalt:~# mkdir /etc/net/ifaces/tethernet1<br>root@hvalt:~# cp /etc/net/ifaces/tethernet/* /etc/net/ifaces/tethernet1<br>root@hvalt:~# rm -f /etc/net/ifaces/tethernet/{i,r}*<br>root@hvalt:~# ls /etc/net/ifaces/tethernet1/<br>ipv4address  options  resolv.conf<br>root@hvalt:~# cat /etc/net/ifaces/tethernet1/options<br>BOOTPROTO=dhcp<br>TYPE=eth<br>NM_CONTROLLED=yes<br>DISABLED=yes<br>CONFIG_WIRELESS=no<br>SYSTEMD_BOOTPROTO=dhcp4<br>CONFIG_IPV4=yes<br>SYSTEMD_CONTROLLED=no<br>root@hvalt:~# vim /etc/net/ifaces/tethernet1/options<br>root@hvalt:~# ls /etc/net/ifaces/<br>default  tethernet  lo  unknown  tethernet1<br>root@hvalt:~# vim /etc/net/ifaces/tethernet1/options<br>root@hvalt:~# cat /etc/net/ifaces/tethernet1/options<br>BOOTPROTO=static<br>CONFIG_WIRELESS=no<br>CONFIG_IPV4=yes<br>HOST='tethernet'<br>ONBOOT=yes<br>TYPE=bri<br>root@hvalt:~# ls /etc/net/ifaces/tethernet/<br>ipv4address  options  resolv.conf<br>root@hvalt:~# service network restart<br><strong>Source:</strong> <br># https://www.altlinux.org/ActiveDirectory/Login#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2 <br># https://www.altlinux.org/SSSD/AD <br># https://www.altlinux.org/%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%BC%D0%BE%D1%81%D1%82 <br># https://www.altlinux.org/PostgreSQL#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B8_%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA <br># https://www.tecmint.com/install-postgresql-and-pgadmin-in-ubuntu/ <br># https://o7planning.org/11353/install-pgadmin-on-ubuntu <br># https://redos.red-soft.ru/base/server-configuring/dbms/install-postgresql/?sphrase_id=53348 <br># https://redos.red-soft.ru/base/server-configuring/dbms/pgadmin4/</p>